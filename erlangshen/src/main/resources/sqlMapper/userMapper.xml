<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.website.dao.UserDaoMapper">
	<resultMap id="userBO" type="com.website.model.bo.UserBO">
		<id column="ID" property="id"/>
		<result column="CLIENT_ID" property="clientId"/>
        <result column="SOURCE" property="source"/>
		<result column="PWD" property="pwd"/>
		<result column="USERNAME" property="username"/>
		<result column="NICKNAME" property="nickname"/>
		<result column="MAIL" property="mail"/>
		<result column="PHONE" property="phone"/>
		<result column="TEL" property="tel"/>
		<result column="QQ" property="qq"/>
		<result column="WEIXIN" property="weixin"/>
		<result column="WEXIN_IMG" property="wexinImg"/>
		<result column="WEIBO" property="weibo"/>
		<result column="HEAD" property="head"/>
		<result column="NAME" property="name"/>
		<result column="SEX" property="sex"/>
		<result column="IDCARD" property="idcard"/>
		<result column="IDCARD_IMG" property="idcardImg"/>
		<result column="PROVINCE" property="province"/>
		<result column="CITY" property="city"/>
		<result column="AREA" property="area"/>
		<result column="ADDRESS" property="address"/>
		<result column="CREATED_TIME" property="createdTime"/>
		<result column="STATUS" property="status"/>
	</resultMap>
	<resultMap extends="userBO" id="userVO" type="com.website.model.vo.UserVO">
		<result column="CLIENT_NAME" property="clientName"/>
	</resultMap>

	<select id="check" parameterType="com.website.model.bo.UserBO" resultMap="userVO">
		SELECT
		t0.ID,t0.CLIENT_ID,t0.SOURCE,t0.PWD,t0.USERNAME,t0.NICKNAME,t0.MAIL,t0.PHONE,t0.TEL,t0.QQ,t0.WEIXIN,t0.WEXIN_IMG,t0.WEIBO,t0.HEAD,t0.`NAME`,t0.SEX,t0.IDCARD,t0.IDCARD_IMG,t0.PROVINCE,t0.CITY,t0.AREA,t0.ADDRESS,t0.CREATED_TIME,t0.STATUS
		FROM `user` t0,client t1
		WHERE t0.CLIENT_ID=t1.ID AND t1.DELETED=0
		  AND t1.ID=#{clientId}
		  AND (t0.USERNAME=#{username} OR t0.MAIL=#{username} OR t0.PHONE=#{username})
		  <if test="pwd != null">
		  	  AND t0.PWD=#{pwd}
		  </if>
	</select>

	<insert id="insert" keyProperty="id" parameterType="com.website.model.bo.UserBO" useGeneratedKeys="true">
		INSERT user
		(ID,CLIENT_ID,SOURCE,PWD,USERNAME,NICKNAME,MAIL,PHONE,TEL,QQ,WEIXIN,WEXIN_IMG,WEIBO,HEAD,`NAME`,SEX,IDCARD,IDCARD_IMG,PROVINCE,CITY,AREA,ADDRESS,CREATED_TIME,STATUS)
		VALUES
		(#{id},#{clientId},#{source},#{pwd},#{username},#{nickname},#{mail},#{phone},#{tel},#{qq},#{weixin},#{wexinImg},#{weibo},#{head},#{name},#{sex},#{idcard},#{idcardImg},#{province},#{city},#{area},#{address},#{createdTime},#{status})
	</insert>

	<insert id="insertBatch" parameterType="java.util.List">
		INSERT user
		(ID,CLIENT_ID,SOURCE,PWD,USERNAME,NICKNAME,MAIL,PHONE,TEL,QQ,WEIXIN,WEXIN_IMG,WEIBO,HEAD,`NAME`,SEX,IDCARD,IDCARD_IMG,PROVINCE,CITY,AREA,ADDRESS,CREATED_TIME,STATUS)
		VALUES
		<foreach collection="list" index="index" item="item" separator=",">
			(#{item.id},#{item.clientId},#{item.source},#{item.pwd},#{item.username},#{item.nickname},#{item.mail},#{item.phone},#{item.tel},#{item.qq},#{item.weixin},#{item.wexinImg},#{item.weibo},#{item.head},#{item.name},#{item.sex},#{item.idcard},#{item.idcardImg},#{item.province},#{item.city},#{item.area},#{item.address},#{item.createdTime},#{item.status})
		</foreach>
	</insert>

	<update id="update" parameterType="com.website.model.bo.UserBO">
		UPDATE user
		<trim prefix="SET" suffixOverrides=",">
			<if test="clientId != null">
				CLIENT_ID=#{clientId},
			</if>
			<if test="source != null">
				SOURCE=#{source},
			</if>
			<if test="pwd != null">
				PWD=#{pwd},
			</if>
			<if test="username != null">
				USERNAME=#{username},
			</if>
			<if test="nickname != null">
				NICKNAME=#{nickname},
			</if>
			<if test="mail != null">
				MAIL=#{mail},
			</if>
			<if test="phone != null">
				PHONE=#{phone},
			</if>
			<if test="tel != null">
				TEL=#{tel},
			</if>
			<if test="qq != null">
				QQ=#{qq},
			</if>
			<if test="weixin != null">
				WEIXIN=#{weixin},
			</if>
			<if test="wexinImg != null">
				WEXIN_IMG=#{wexinImg},
			</if>
			<if test="weibo != null">
				WEIBO=#{weibo},
			</if>
			<if test="head != null">
				HEAD=#{head},
			</if>
			<if test="name != null">
				`NAME`=#{name},
			</if>
			<if test="sex != null">
				SEX=#{sex},
			</if>
			<if test="idcard != null">
				IDCARD=#{idcard},
			</if>
			<if test="idcardImg != null">
				IDCARD_IMG=#{idcardImg},
			</if>
			<if test="province != null">
				PROVINCE=#{province},
			</if>
			<if test="city != null">
				CITY=#{city},
			</if>
			<if test="area != null">
				AREA=#{area},
			</if>
			<if test="address != null">
				ADDRESS=#{address},
			</if>
			<if test="createdTime != null">
				CREATED_TIME=#{createdTime},
			</if>
			<if test="status != null">
				STATUS=#{status},
			</if>
		</trim>
		WHERE id=#{id}
	</update>

	<update id="updateBatch" parameterType="java.util.List">
		<foreach collection="list" index="index" item="item" separator=";">
			UPDATE user
			<trim prefix="SET" suffixOverrides=",">
				<if test="clientId != null">
					CLIENT_ID=#{item.clientId},
				</if>
				<if test="source != null">
					SOURCE=#{source},
				</if>
				<if test="pwd != null">
					PWD=#{item.pwd},
				</if>
				<if test="username != null">
					USERNAME=#{item.username},
				</if>
				<if test="nickname != null">
					NICKNAME=#{item.nickname},
				</if>
				<if test="mail != null">
					MAIL=#{item.mail},
				</if>
				<if test="phone != null">
					PHONE=#{item.phone},
				</if>
				<if test="tel != null">
					TEL=#{item.tel},
				</if>
				<if test="qq != null">
					QQ=#{item.qq},
				</if>
				<if test="weixin != null">
					WEIXIN=#{item.weixin},
				</if>
				<if test="wexinImg != null">
					WEXIN_IMG=#{item.wexinImg},
				</if>
				<if test="weibo != null">
					WEIBO=#{item.weibo},
				</if>
				<if test="head != null">
					HEAD=#{item.head},
				</if>
				<if test="name != null">
					`NAME`=#{item.name},
				</if>
				<if test="sex != null">
					SEX=#{item.sex},
				</if>
				<if test="idcard != null">
					IDCARD=#{item.idcard},
				</if>
				<if test="idcardImg != null">
					IDCARD_IMG=#{item.idcardImg},
				</if>
				<if test="province != null">
					PROVINCE=#{item.province},
				</if>
				<if test="city != null">
					CITY=#{item.city},
				</if>
				<if test="area != null">
					AREA=#{item.area},
				</if>
				<if test="address != null">
					ADDRESS=#{item.address},
				</if>
				<if test="createdTime != null">
					CREATED_TIME=#{item.createdTime},
				</if>
				<if test="status != null">
					STATUS=#{item.status},
				</if>
			</trim>
			WHERE id=#{id}
		</foreach>
	</update>

	<delete id="delete" parameterType="String">
		DELETE FROM user WHERE id=#{id}
	</delete>

	<delete id="deleteBatch" parameterType="java.util.List">
		DELETE FROM user WHERE id IN
		<foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
			#{item}
		</foreach>
	</delete>

	<select id="findById" parameterType="string" resultMap="userVO">
		SELECT
		ID,CLIENT_ID,SOURCE,PWD,USERNAME,NICKNAME,MAIL,PHONE,TEL,QQ,WEIXIN,WEXIN_IMG,WEIBO,HEAD,NAME,SEX,IDCARD,IDCARD_IMG,PROVINCE,CITY,AREA,ADDRESS,CREATED_TIME,STATUS
		FROM user
		WHERE id=#{id}
	</select>

	<select id="queryByOr" parameterType="com.website.model.bo.UserBO" resultMap="userVO">
		SELECT
		ID,CLIENT_ID,SOURCE,USERNAME,NICKNAME,MAIL,PHONE,TEL,QQ,WEIXIN,WEXIN_IMG,WEIBO,HEAD,`NAME`,SEX,IDCARD,IDCARD_IMG,PROVINCE,CITY,AREA,ADDRESS,CREATED_TIME,STATUS
		FROM user
		<where>
			<if test="clientId != null">
				or CLIENT_ID=#{clientId}
			</if>
			<if test="source != null">
				OR SOURCE=#{source}
			</if>
			<if test="username != null">
				or USERNAME=#{username}
			</if>
			<if test="nickname != null">
				or NICKNAME=#{nickname}
			</if>
			<if test="mail != null">
				or MAIL=#{mail}
			</if>
			<if test="phone != null">
				or PHONE=#{phone}
			</if>
			<if test="tel != null">
				or TEL=#{tel}
			</if>
			<if test="qq != null">
				or QQ=#{qq}
			</if>
			<if test="weixin != null">
				or WEIXIN=#{weixin}
			</if>
			<if test="wexinImg != null">
				or WEXIN_IMG=#{wexinImg}
			</if>
			<if test="weibo != null">
				or WEIBO=#{weibo}
			</if>
			<if test="head != null">
				or HEAD=#{head}
			</if>
			<if test="name != null">
				or `NAME`=#{name}
			</if>
			<if test="sex != null">
				or SEX=#{sex}
			</if>
			<if test="idcard != null">
				or IDCARD=#{idcard}
			</if>
			<if test="idcardImg != null">
				or IDCARD_IMG=#{idcardImg}
			</if>
			<if test="province != null">
				or PROVINCE=#{province}
			</if>
			<if test="city != null">
				or CITY=#{city}
			</if>
			<if test="area != null">
				or AREA=#{area}
			</if>
			<if test="address != null">
				or ADDRESS=#{address}
			</if>
			<if test="createdTime != null">
				or CREATED_TIME=#{createdTime}
			</if>
			<if test="status != null">
				or STATUS=#{status}
			</if>
		</where>
	</select>

	<select id="queryByAnd" parameterType="com.website.model.bo.UserBO" resultMap="userVO">
		SELECT
		ID,CLIENT_ID,SOURCE,USERNAME,NICKNAME,MAIL,PHONE,TEL,QQ,WEIXIN,WEXIN_IMG,WEIBO,HEAD,`NAME`,SEX,IDCARD,IDCARD_IMG,PROVINCE,CITY,AREA,ADDRESS,CREATED_TIME,STATUS
		FROM user
		<where>
			<if test="clientId != null">
				and CLIENT_ID=#{clientId}
			</if>
			<if test="source != null">
				OR SOURCE=#{source}
			</if>
			<if test="username != null">
				and USERNAME=#{username}
			</if>
			<if test="nickname != null">
				and NICKNAME=#{nickname}
			</if>
			<if test="mail != null">
				and MAIL=#{mail}
			</if>
			<if test="phone != null">
				and PHONE=#{phone}
			</if>
			<if test="tel != null">
				and TEL=#{tel}
			</if>
			<if test="qq != null">
				and QQ=#{qq}
			</if>
			<if test="weixin != null">
				and WEIXIN=#{weixin}
			</if>
			<if test="wexinImg != null">
				and WEXIN_IMG=#{wexinImg}
			</if>
			<if test="weibo != null">
				and WEIBO=#{weibo}
			</if>
			<if test="head != null">
				and HEAD=#{head}
			</if>
			<if test="name != null">
				and `NAME`=#{name}
			</if>
			<if test="sex != null">
				and SEX=#{sex}
			</if>
			<if test="idcard != null">
				and IDCARD=#{idcard}
			</if>
			<if test="idcardImg != null">
				and IDCARD_IMG=#{idcardImg}
			</if>
			<if test="province != null">
				and PROVINCE=#{province}
			</if>
			<if test="city != null">
				and CITY=#{city}
			</if>
			<if test="area != null">
				and AREA=#{area}
			</if>
			<if test="address != null">
				and ADDRESS=#{address}
			</if>
			<if test="createdTime != null">
				and CREATED_TIME=#{createdTime}
			</if>
			<if test="status != null">
				and STATUS=#{status}
			</if>
		</where>
	</select>

	<select id="queryByClient" parameterType="com.website.model.vo.UserVO" resultMap="userVO">
		SELECT
		`user`.ID,`user`.CLIENT_ID,`user`.SOURCE,`user`.USERNAME,`user`.NICKNAME,`user`.MAIL,`user`.PHONE,`user`.TEL,`user`.QQ,`user`.WEIXIN,`user`.WEXIN_IMG,`user`.WEIBO,`user`.HEAD,`user`.`NAME`,`user`.SEX,`user`.IDCARD,`user`.IDCARD_IMG,`user`.PROVINCE,`user`.CITY,`user`.AREA,`user`.ADDRESS,`user`.CREATED_TIME,`user`.STATUS,
		client.NAME as CLIENT_NAME
		FROM `user`,client
		WHERE `user`.CLIENT_ID=client.ID AND client.deleted=0
		<if test="clientName != null">
			and client.NAME=#{clientName}
		</if>
		<if test="createdBy != null">
			and client.CREATED_BY=#{createdBy}
		</if>
		<if test="clientId != null">
			and `user`.CLIENT_ID=#{clientId}
		</if>
		<if test="source != null">
			and `user`.SOURCE=#{source}
		</if>
		<if test="username != null">
			and `user`.USERNAME like CONCAT('%',#{username},'%')
		</if>
		<if test="nickname != null">
			and `user`.NICKNAME like CONCAT('%',#{nickname},'%')
		</if>
		<if test="mail != null">
			and `user`.MAIL like CONCAT('%',#{mail},'%')
		</if>
		<if test="phone != null">
			and `user`.PHONE like CONCAT('%',#{phone},'%')
		</if>
		<if test="tel != null">
			and `user`.TEL like CONCAT('%',#{tel},'%')
		</if>
		<if test="qq != null">
			and `user`.QQ like CONCAT('%',#{qq},'%')
		</if>
		<if test="weixin != null">
			and `user`.WEIXIN like CONCAT('%',#{weixin},'%')
		</if>
		<if test="weibo != null">
			and `user`.WEIBO like CONCAT('%',#{weibo},'%')
		</if>
		<if test="name != null">
			and `user`.`NAME` like CONCAT('%',#{name},'%')
		</if>
		<if test="sex != null">
			and `user`.SEX=#{sex}
		</if>
		<if test="idcard != null">
			and `user`.IDCARD like CONCAT('%',#{idcard},'%')
		</if>
		<if test="province != null">
			and `user`.PROVINCE=#{province}
		</if>
		<if test="city != null">
			and `user`.CITY=#{city}
		</if>
		<if test="area != null">
			and `user`.AREA=#{area}
		</if>
		<if test="address != null">
			and `user`.ADDRESS like CONCAT('%',#{address},'%')
		</if>
		<if test="status != null">
			and `user`.STATUS=#{status}
		</if>
	</select>

</mapper>
